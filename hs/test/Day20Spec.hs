{-# LANGUAGE OverloadedStrings #-}
module Day20Spec (spec) where

import Data.Text (Text)
import qualified Data.Text as T (unlines)
import Day20 (day20a, day20b)
import Test.Hspec (Spec, describe, it, shouldBe, it)

example :: Text
example = T.unlines
  [ "Tile 2311:"
  , "..##.#..#."
  , "##..#....."
  , "#...##..#."
  , "####.#...#"
  , "##.##.###."
  , "##...#.###"
  , ".#.#.#..##"
  , "..#....#.."
  , "###...#.#."
  , "..###..###"
  , ""
  , "Tile 1951:"
  , "#.##...##."
  , "#.####...#"
  , ".....#..##"
  , "#...######"
  , ".##.#....#"
  , ".###.#####"
  , "###.##.##."
  , ".###....#."
  , "..#.#..#.#"
  , "#...##.#.."
  , ""
  , "Tile 1171:"
  , "####...##."
  , "#..##.#..#"
  , "##.#..#.#."
  , ".###.####."
  , "..###.####"
  , ".##....##."
  , ".#...####."
  , "#.##.####."
  , "####..#..."
  , ".....##..."
  , ""
  , "Tile 1427:"
  , "###.##.#.."
  , ".#..#.##.."
  , ".#.##.#..#"
  , "#.#.#.##.#"
  , "....#...##"
  , "...##..##."
  , "...#.#####"
  , ".#.####.#."
  , "..#..###.#"
  , "..##.#..#."
  , ""
  , "Tile 1489:"
  , "##.#.#...."
  , "..##...#.."
  , ".##..##..."
  , "..#...#..."
  , "#####...#."
  , "#..#.#.#.#"
  , "...#.#.#.."
  , "##.#...##."
  , "..##.##.##"
  , "###.##.#.."
  , ""
  , "Tile 2473:"
  , "#....####."
  , "#..#.##..."
  , "#.##..#..."
  , "######.#.#"
  , ".#...#.#.#"
  , ".#########"
  , ".###.#..#."
  , "########.#"
  , "##...##.#."
  , "..###.#.#."
  , ""
  , "Tile 2971:"
  , "..#.#....#"
  , "#...###..."
  , "#.#.###..."
  , "##.##..#.."
  , ".#####..##"
  , ".#..####.#"
  , "#..#.#..#."
  , "..####.###"
  , "..#.#.###."
  , "...#.#.#.#"
  , ""
  , "Tile 2729:"
  , "...#.#.#.#"
  , "####.#...."
  , "..#.#....."
  , "....#..#.#"
  , ".##..##.#."
  , ".#.####..."
  , "####.#.#.."
  , "##.####..."
  , "##..#.##.."
  , "#.##...##."
  , ""
  , "Tile 3079:"
  , "#.#.#####."
  , ".#..######"
  , "..#......."
  , "######...."
  , "####.#..#."
  , ".#...#.##."
  , "#.#####.##"
  , "..#.###..."
  , "..#......."
  , "..#.###..."
  ]

spec :: Spec
spec = do
    describe "part 1" $ do
        it "examples" $ do
            day20a example `shouldBe` Right (Just 20899048083289)
    describe "part 2" $ do
        it "examples" $ do
            day20b example `shouldBe` Right (Just 273)
